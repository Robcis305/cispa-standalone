// Backup of original complex implementation